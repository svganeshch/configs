$(document).ready(function(){$('[data-toggle="tooltip"]').tooltip();var u=0,t=0,r=0,q=0;var g;var s;var n;var j;var v;var m;var o;var k=false;$("#device_profile").val(localStorage.getItem("device_profile"));$.ajax({url:"/utils/data/get_data.php",method:"POST",data:{getData:"yes",device_profile:localStorage.getItem("device_profile")},success:function(c){var a=$.parseJSON(c);var b=0;if(a!=null){$.each(a,function(d,w){$("#global_override").bootstrapToggle((w.global_override=="yes")?"on":"off");$("#is_official").bootstrapToggle((w.is_official=="yes")?"on":"off");$("#test_build").bootstrapToggle((w.test_build=="yes")?"on":"off");$("#force_clean").bootstrapToggle((w.force_clean=="yes")?"on":"off");$("#default_buildtype_state").bootstrapToggle((w.default_buildtype_state=="yes")?"on":"off");$("#buildtype").val(w.buildtype);$("#buildvariant").val(w.buildvariant);$("#bootimage").bootstrapToggle((w.bootimage=="yes")?"on":"off");$("#weeklies_opt").bootstrapToggle((w.weeklies_opt=="yes")?"on":"off");$("#force_node").val(w.force_node);g=$.parseJSON(w.repo_paths);s=$.parseJSON(w.repo_clones);n=$.parseJSON(w.repo_clones_paths);j=$.parseJSON(w.repopick_topics);v=$.parseJSON(w.repopick_changes);m=w.changelog;o=w.xda_link})}if(g!=null&&g!="null"&&g!="NULL"){$.each(g,function(d,w){if(w!=null&&w!="null"&&w!="NULL"){for(b=0;b<=w.length-1;b++){if(b!=0){if($("#repo_paths_text_field"+b+"").length==0){$("#add1").trigger("click")}}$("#repo_paths_text_field"+u+"").val(w[b])}}})}if(s!=null&&s!="null"&&s!="NULL"){$.each(s,function(w,y){if(y!=null&&y!="null"&&y!="NULL"){for(b=0;b<=y.length-1;b++){if($("#repo_clones_text_field"+b+"").length==0){$("#add2").trigger("click")}var d=y[b];if(d.includes("-b")){var x=d.split("-b");$("#repo_clones_text_field"+t+"").val(x[0].trim());$("#repo_clone_branch_text_field"+t+"").val(x[1].trim())}else{$("#repo_clones_text_field"+t+"").val(d)}}}})}if(n!=null&&n!="null"&&n!="NULL"){$.each(n,function(d,w){if(w!=null&&w!="null"&&w!="NULL"){for(b=0;b<=w.length-1;b++){t=b;$("#repo_clones_paths_text_field"+t+"").val(w[b])}}})}if(j!=null&&j!="null"&&j!="NULL"){$.each(j,function(d,w){if(w!=null&&w!="null"&&w!="NULL"){for(b=0;b<=w.length-1;b++){if($("#repopick_topics_text_field"+b+"").length==0){$("#add3").trigger("click")}$("#repopick_topics_text_field"+r+"").val(w[b])}}})}if(v!=null&&v!="null"&&v!="NULL"){$.each(v,function(d,w){if(w!=null&&w!="null"&&w!="NULL"){for(b=0;b<=w.length-1;b++){if($("#repopick_changes_text_field"+b+"").length==0){$("#add4").trigger("click")}$("#repopick_changes_text_field"+q+"").val(w[b])}}})}if(o!=null&&o!="null"&&o!="NULL"){$("#xda_link").val(o)}else{$("#xda_link").val("")}if(m!=null&&m!="null"&&m!="NULL"){$("#changelog").val(m)}else{$("#changelog").val("")}}});$("body").on("click","#add1",function(){u++;$("#dynamic_field-1-").append('<li class="list-group-item" style="border:none" id="dynamic_field-repo_paths'+u+'"><div class="row"><div class="col-md-11 col-xs-11" style="padding-left:0px"><div class="form-group" id="repo_paths_group'+u+'"><input autocomplete="on" type="text" id="repo_paths_text_field'+u+'" name="repo_paths[]" class="form-control" /></div></div><button type="button" name="remove" id="repo_paths'+u+'" class="btn btn-danger btn_remove" style="margin-top: 5px;">X</button></div></li>');$("#repo_paths_text_field"+u+"").focus()});$("body").on("click","#add2",function(){t++;$("#dynamic_field-2-").append('<li class="list-group-item" style="border:none" id="dynamic_field-repo_clones'+t+'"><div class="row"><div class="col-md-11 col-xs-11" style="padding-left:0px"><div class="row"><div class="col-md-8 col-xs-8"><div class="form-group" id="repo_clones_group'+t+'"><input placeholder="repo url" autocomplete="on" type="text" id="repo_clones_text_field'+t+'" name="repo_clones[]" class="form-control" /></div></div><div class="col-md-4 col-xs-4"><div class="form-group" id="repo_clone_branch_group'+t+'"><input placeholder="branch" autocomplete="on" type="text" id="repo_clone_branch_text_field'+t+'" name="repo_clone_branch[]" class="form-control" /></div></div></div><br class="custom_br" id="custom_br"/><div class="form-group" id="repo_clones_paths_group'+t+'"><input placeholder="path for repo" autocomplete="on" type="text" id="repo_clones_paths_text_field'+t+'" name="repo_clones_paths[]" class="form-control" /></div></div><button type="button" name="remove" id="repo_clones'+t+'" class="btn btn-danger btn_remove" style="margin-top: 5px;">X</button></div></li>');$("#repo_clones_text_field"+t+"").focus()});$("body").on("click","#add3",function(){r++;$("#dynamic_field-3-").append('<li class="list-group-item" style="border:none" id="dynamic_field-repopick_topics'+r+'"><div class="row"><div class="col-md-11 col-xs-11" style="padding-left:0px"><div class="form-group" id="repopick_topics_group'+r+'"><input autocomplete="on" type="text" id="repopick_topics_text_field'+r+'" name="repopick_topics[]" class="form-control" /></div></div><button type="button" name="remove" id="repopick_topics'+r+'" class="btn btn-danger btn_remove" style="margin-top: 5px;">X</button></div></li>');$("#repopick_topics_text_field"+r+"").focus()});$("body").on("click","#add4",function(){q++;$("#dynamic_field-4-").append('<li class="list-group-item" style="border:none" id="dynamic_field-repopick_changes'+q+'"><div class="row"><div class="col-md-11 col-xs-11" style="padding-left:0px"><div class="form-group" id="repopick_changes_group'+q+'"><input autocomplete="on" type="text" id="repopick_changes_text_field'+q+'" name="repopick_changes[]" class="form-control" /></div></div><button type="button" name="remove" id="repopick_changes'+q+'" class="btn btn-danger btn_remove" style="margin-top: 5px;">X</button></div></li>');$("#repopick_changes_text_field"+q+"").focus()});$("#global_override").bootstrapToggle({on:"Yes",off:"No",onstyle:"success",offstyle:"danger"});$("body").on("change","#global_override",function(){if($(this).prop("checked")){$("#default_buildtype_state").trigger("change");$("#hidden_global_override").val("yes");$("#switch-block").show()}else{$("#default_buildtype_state").trigger("change");$("#hidden_global_override").val("no");$("#switch-block").hide()}});$("#is_official").bootstrapToggle({on:"Yes",off:"No",onstyle:"success",offstyle:"danger"});$("body").on("change","#is_official",function(){if($(this).prop("checked")){$("#hidden_is_official").val("yes")}else{$("#hidden_is_official").val("no")}});$("#test_build").bootstrapToggle({on:"Yes",off:"No",onstyle:"success",offstyle:"danger"});$("body").on("change","#test_build",function(){if($(this).prop("checked")){$("#hidden_test_build").val("yes")}else{$("#hidden_test_build").val("no")}});$("#force_clean").bootstrapToggle({on:"Yes",off:"No",onstyle:"success",offstyle:"danger"});$("body").on("change","#force_clean",function(){if($(this).prop("checked")){$("#hidden_force_clean").val("yes")}else{$("#hidden_force_clean").val("no")}});$("#default_buildtype_state").bootstrapToggle({on:"Yes",off:"No",onstyle:"success",offstyle:"danger"});$("body").on("change","#default_buildtype_state",function(){if($(this).prop("checked")){$("#hidden_default_buildtype_state").val("yes");$("#buildtype_div").hide()}else{$("#hidden_default_buildtype_state").val("no");$("#buildtype_div").show()}});$("body").on("click","#PipelineBuildTrigger",function(){$("#notifyDialog").modal({backdrop:"static",keyboard:false,show:true});$("#notifyDialogData").text("Please wait...!");$.ajax({url:"/utils/jenkins/jenkinsBlueFunc.php",method:"POST",data:{PipelineBuildTrigger:"yes"},success:function(a){a=a.trim();$("#notifyDialogData").text(a);setTimeout(function(){$("#notifyDialog").modal("hide")},2000)}})});$("#bootimage").bootstrapToggle({on:"Yes",off:"No",onstyle:"success",offstyle:"danger"});$("body").on("change","#bootimage",function(){if($(this).prop("checked")){$("#hidden_bootimage").val("yes")}else{$("#hidden_bootimage").val("no")}});$("#weeklies_opt").bootstrapToggle({on:"Opt In",off:"Opt Out",onstyle:"success",offstyle:"danger"});$("body").on("change","#weeklies_opt",function(){if($(this).prop("checked")){$("#hidden_weeklies_opt").val("yes")}else{$("#hidden_weeklies_opt").val("no")}});$(document).on("click",".btn_remove",function(){var a=$(this).attr("id");$("#dynamic_field-"+a+"").remove()});function p(w,c,d){var b=0;var a=true;$.each(w,function(x,y){if(y!=null){if(x==d){$.each(c,function(A,z){if(y[b]==$("#"+z).val()){$("#"+d+"_group"+z[z.length-1]).addClass("has-error has-feedback").append('<span class="glyphicon glyphicon-remove form-control-feedback" id="field-error-icon"></span>');$("#"+d+"_text_field"+z[z.length-1]).focus();b++;a=false}})}}});return a}function f(){$.ajax({async:false,url:"/utils/validateFields.php",method:"POST",data:$("#device_changes").serialize(),success:function(w){var y=$.parseJSON(w);var c=$("input[name='repo_paths[]']").map(function(){return $(this).attr("id")}).get();$("[id^=repo_paths_group]").removeClass("has-error has-feedback");var z=$("input[name='repo_clones[]']").map(function(){return $(this).attr("id")}).get();$("[id^=repo_clones_group]").removeClass("has-error has-feedback");var a=$("input[name='repo_clone_branch[]']").map(function(){return $(this).attr("id")}).get();$("[id^=repo_clone_branch_group]").removeClass("has-error has-feedback");var d=$("input[name='repo_clones_paths[]']").map(function(){return $(this).attr("id")}).get();$("[id^=repo_clones_paths_group]").removeClass("has-error has-feedback");var x=$("input[name='repopick_topics[]']").map(function(){return $(this).attr("id")}).get();$("[id^=repopick_topics_group]").removeClass("has-error has-feedback");var b=$("input[name='repopick_changes[]']").map(function(){return $(this).attr("id")}).get();$("[id^=repopick_changes_group]").removeClass("has-error has-feedback");$("span[id^=field-error-icon]").remove();is_rp_ok=p(y,c,"repo_paths");is_rcd_ok=p(y,z,"repo_clones");is_rcb_ok=p(y,a,"repo_clone_branch");is_rcp_ok=p(y,d,"repo_clones_paths");is_rptp_ok=p(y,x,"repopick_topics");is_rpc_ok=p(y,b,"repopick_changes");k=is_rp_ok&&is_rcd_ok&&is_rcb_ok&&is_rcp_ok&&is_rptp_ok&&is_rpc_ok}});return k}$("body").on("click","#submit",function(){$("#notifyDialog").modal({backdrop:"static",keyboard:false,show:true});if(!f()){$("#notifyDialogData").text("Invalid data...!!");setTimeout(function(){$("#notifyDialog").modal("hide")},800);return}$("#notifyDialogData").text("Please wait...!");$.ajax({url:"/utils/data/send_data.php",method:"POST",data:$("#device_changes").serialize(),success:function(a){a=a.trim();$("#notifyDialogData").text(a);setTimeout(function(){$("#notifyDialog").modal("hide")},2000)}})});$("body").on("click","#clone_profile",function(){$("#notifyDialog").modal({backdrop:"static",keyboard:false,show:true});if(!f()){$("#notifyDialogData").text("Invalid data...!!");setTimeout(function(){$("#notifyDialog").modal("hide")},800);return}$("#notifyDialogData").text("Please wait cloning profile...!");$.ajax({url:"/utils/data/send_data.php",method:"POST",data:$("#device_changes").serialize()+"&clone_profile=yes",success:function(a){a=a.trim();$("#notifyDialogData").text(a);setTimeout(function(){$("#notifyDialog").modal("hide")},2000)}})});$("body").on("click","#buildTrigger",function(){$("#submit").trigger("click");if(!k){return}$("#notifyDialog").modal({backdrop:"static",keyboard:false,show:true});$("#notifyDialogData").text("Please wait...!");$.ajax({async:false,url:"/utils/jenkins/jenkinsBlueFunc.php",method:"POST",data:{buildTrigger:"yes"},success:function(a){$("#buildOutput").empty();a=a.trim();$("#notifyDialogData").text(a);setTimeout(function(){$("#notifyDialog").modal("hide")},2000)}})});$("body").on("click","#buildRemoveQueue",function(){$("#notifyDialog").modal({backdrop:"static",keyboard:false,show:true});$("#notifyDialogData").text("Please wait...!");$.ajax({url:"/utils/jenkins/jenkinsBlueFunc.php",method:"POST",data:{buildRemoveQueue:"yes"},success:function(a){a=a.trim();$("#notifyDialogData").text(a);setTimeout(function(){$("#notifyDialog").modal("hide")},2000)}})});$("body").on("click","#buildStop",function(){$("#notifyDialog").modal({backdrop:"static",keyboard:false,show:true});$("#notifyDialogData").text("Please wait...!");$.ajax({url:"/utils/jenkins/jenkinsBlueFunc.php",method:"POST",data:{buildStop:"yes"},success:function(a){a=a.trim();$("#notifyDialogData").text(a);setTimeout(function(){$("#notifyDialog").modal("hide")},2000)}})});$("#device_profile").change(function(b){var a=$("#device_profile").val();localStorage.setItem("device_profile",a);$.post("/helpers/setProfile.php",{device_profile:a});window.location.href=window.location.href});$("#build-progress-bar").hide();function h(){$.ajax({method:"POST",url:"/utils/jenkins/jenkinsBlueFunc.php",data:{getProgressStatus:"yes"},success:function(a){a=a.trim();$(".progress-bar").css("width",a+"%").attr("aria-valuenow",a).text(a+"%")}})}function i(){$.ajax({method:"POST",url:"/utils/jenkins/jenkinsBlueFunc.php",data:{getHeaderTextSize:"yes",},success:function(b){if(b!=null){var a=JSON.parse(b);window.curTextSize=Number(a["x-text-size"])}}})}function l(){$.ajax({method:"POST",url:"/utils/jenkins/jenkinsBlueFunc.php",data:{getBuildStatus:"yes"},success:function(a){$("#buildStatus").text(a);a=a.trim();if((a.localeCompare("building"))==0||window.Morelog=="true"){$("#build-progress-bar").show();h()}else{if((a.localeCompare("idle"))==0){}}window.jenkinsLooper=setTimeout(function(){l()},5000)}})}var e=$("#config_dev_name").text().trim();if(e!="Common_config config:"){l()}$("body").on("click","#reset-hard",function(){$("#is_official").bootstrapToggle("on");$("#test_build").bootstrapToggle("off");$("#force_clean").bootstrapToggle("off");$("#buildtype").val("userdebug");$("#buildvariant").val("vanilla");$("#bootimage").bootstrapToggle("off");$("#weeklies_opt").bootstrapToggle("on");$("default_buildtype_state").bootstrapToggle("on")})});