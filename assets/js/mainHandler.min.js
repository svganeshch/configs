$(document).ready(function(){$('[data-toggle="tooltip"]').tooltip();var e=0,o=0,t=0,l=0,i=$("#config_dev_name").text(),n="",s="no";function a(i){$.ajax({url:"get_data.php",method:"GET"}).done(function(a){var c=$.parseJSON(a),d=0;null!=c&&$.each(c,function(a,c){if("cur_dev"==i){n=c.lunch_override_name,"no"==s&&$("#override_lunch").bootstrapToggle("yes"==c.lunch_override_state?"on":"off"),$("#global_override").bootstrapToggle("yes"==c.global_override?"on":"off"),$("#is_official").bootstrapToggle("yes"==c.is_official?"on":"off"),$("#test_build").bootstrapToggle("yes"==c.test_build?"on":"off"),$("#force_clean").bootstrapToggle("yes"==c.force_clean?"on":"off"),$("#default_buildtype_state").bootstrapToggle("yes"==c.default_buildtype_state?"on":"off"),$("#buildtype").val(c.buildtype),$("#bootimage").bootstrapToggle("yes"==c.bootimage?"on":"off");var r=$.parseJSON(c.repo_paths),p=$.parseJSON(c.repo_clones),_=$.parseJSON(c.repo_clones_paths),u=$.parseJSON(c.repopick_topics),f=$.parseJSON(c.repopick_changes),g=c.changelog,b=c.xda_link}else if("ovr_dev"==i){n=c.lunch_override_name,$("#global_override").bootstrapToggle("yes"==c.global_override?"on":"off"),$("#is_official").bootstrapToggle("yes"==c.ovr_is_official?"on":"off"),$("#test_build").bootstrapToggle("yes"==c.ovr_test_build?"on":"off"),$("#force_clean").bootstrapToggle("yes"==c.ovr_force_clean?"on":"off"),$("#default_buildtype_state").bootstrapToggle("yes"==c.default_buildtype_state?"on":"off"),$("#buildtype").val(c.ovr_buildtype),$("#bootimage").bootstrapToggle("yes"==c.ovr_bootimage?"on":"off");r=$.parseJSON(c.ovr_repo_paths),p=$.parseJSON(c.ovr_repo_clones),_=$.parseJSON(c.ovr_repo_clones_paths),u=$.parseJSON(c.ovr_repopick_topics),f=$.parseJSON(c.ovr_repopick_changes),g=c.ovr_changelog,b=c.ovr_xda_link}null!=r&&"null"!=r&&"NULL"!=r&&$.each(r,function(o,t){if(null!=t&&"null"!=t&&"NULL"!=t)for(d=0;d<=t.length-1;d++)0==d&&$("#int_repo_paths_text_field").val(t[d]),0!=d&&(0==$("#repo_paths_text_field"+d).length&&$("#add1").trigger("click"),$("#repo_paths_text_field"+e).val(t[d]));else $("#int_repo_paths_text_field").val(""),$("#int_repo_paths_text_field").closest("ul").find("input[id^=repo_paths_text_field], textarea").closest("li").remove()}),null!=p&&"null"!=p&&"NULL"!=p&&$.each(p,function(e,t){if(null!=t&&"null"!=t&&"NULL"!=t)for(d=0;d<=t.length-1;d++){var l;if(0==d)if((l=t[d]).includes("-b")){var i=l.split("-b");$("#int_repo_clones_text_field").val(i[0].trim()),$("#int_repo_clone_branch_text_field").val(i[1].trim())}else $("#int_repo_clones_text_field").val(l);if(0!=d)if(0==$("#repo_clones_text_field"+d).length&&$("#add2").trigger("click"),(l=t[d]).includes("-b")){i=l.split("-b");$("#repo_clones_text_field"+o).val(i[0].trim()),$("#repo_clone_branch_text_field"+o).val(i[1].trim())}else $("#repo_clones_text_field"+o).val(l)}else $("#int_repo_clones_text_field").val(""),$("#int_repo_clones_text_field").closest("ul").find("input[id^=repo_clones_text_field], textarea").closest("li").remove()}),null!=_&&"null"!=_&&"NULL"!=_&&$.each(_,function(e,t){if(null!=t&&"null"!=t&&"NULL"!=t)for(d=0;d<=t.length-1;d++)0==d&&$("#int_repo_clones_paths_text_field").val(t[d]),0!=d&&(o=d,$("#repo_clones_paths_text_field"+o).val(t[d]));else $("#int_repo_clones_paths_text_field").val(""),$("#int_repo_clones_paths_text_field").closest("ul").find("input[id^=repo_clones_paths_text_field], textarea").closest("li").remove()}),null!=u&&"null"!=u&&"NULL"!=u&&$.each(u,function(e,o){if(null!=o&&"null"!=o&&"NULL"!=o)for(d=0;d<=o.length-1;d++)0==d&&$("#int_repopick_topics_text_field").val(o[d]),0!=d&&(0==$("#repopick_topics_text_field"+d).length&&$("#add3").trigger("click"),$("#repopick_topics_text_field"+t).val(o[d]));else $("#int_repopick_topics_text_field").val(""),$("#int_repopick_topics_text_field").closest("ul").find("input[id^=repopick_topics_text_field], textarea").closest("li").remove()}),null!=f&&"null"!=f&&"NULL"!=f&&$.each(f,function(e,o){if(null!=o&&"null"!=o&&"NULL"!=o)for(d=0;d<=o.length-1;d++)0==d&&$("#int_repopick_changes_text_field").val(o[d]),0!=d&&(0==$("#repopick_changes_text_field"+d).length&&$("#add4").trigger("click"),$("#repopick_changes_text_field"+l).val(o[d]));else $("#int_repopick_changes_text_field").val(""),$("#int_repopick_changes_text_field").closest("ul").find("input[id^=repopick_changes_text_field], textarea").closest("li").remove()}),null!=b&&"null"!=c&&"NULL"!=c?$("#xda_link").val(b):$("#xda_link").val(""),null!=g&&"null"!=c&&"NULL"!=c?$("#changelog").val(g):$("#changelog").val("")})})}function c(){$.ajax({method:"POST",url:"jenkinsFunc.php",data:{getBuildStatus:"yes"},success:function(e){$("#buildStatus").text(e),0==(e=e.trim()).localeCompare("building")||"true"==window.Morelog?($("#build-progress-bar").show(),$.ajax({method:"POST",url:"jenkinsFunc.php",data:{getProgressStatus:"yes"},success:function(e){e=e.trim(),$(".progress-bar").css("width",e+"%").attr("aria-valuenow",e).text(e+"%")}}),r()):0==e.localeCompare("idle")&&(window.idleLogSetShown||null!=window.curTextSize&&(window.curTextSize>=1e3&&(window.curTextSize=window.curTextSize-1e3,$("#fullLog").show(),r()),r())),window.jenkinsLooper=setTimeout(function(){c()},5e3)}})}a("cur_dev"),$("body").on("click","#add1",function(){e++,$("#dynamic_field-1-").append('<li class="list-group-item" style="border:none" id="dynamic_field-repo_paths'+e+'"><div class="row"> <div class="col-md-11 col-xs-11" style="padding-left:0px"> <div class="form-group"> <input autocomplete="on" type="text" id="repo_paths_text_field'+e+'" name="repo_paths[]" class="form-control" /> </div> </div> <button type="button" name="remove" id="repo_paths'+e+'" class="btn btn-danger btn_remove" style="margin-top: 5px;">X</button></div></li>'),$("#repo_paths_text_field"+e).focus()}),$("body").on("click","#add2",function(){o++,$("#dynamic_field-2-").append('<li class="list-group-item" style="border:none" id="dynamic_field-repo_clones'+o+'"><div class="row"> <div class="col-md-11 col-xs-11" style="padding-left:0px"> <div class="form-group"><div class="row"> <div class="col-md-8 col-xs-8"><input placeholder="repo url" autocomplete="on" type="text" id="repo_clones_text_field'+o+'" name="repo_clones[]" class="form-control" /></div><div class="col-md-4 col-xs-4"> <input placeholder="branch" autocomplete="on" type="text" id="repo_clone_branch_text_field'+o+'" name="repo_clone_branch[]" class="form-control" /> </div></div><br class="custom_br" id="custom_br"/><input placeholder="path for repo" autocomplete="on" type="text" id="repo_clones_paths_text_field'+o+'" name="repo_clones_paths[]" class="form-control" /> </div></div> <button type="button" name="remove" id="repo_clones'+o+'" class="btn btn-danger btn_remove" style="margin-top: 5px;">X</button></div></li>'),$("#repo_clones_text_field"+o).focus()}),$("body").on("click","#add3",function(){t++,$("#dynamic_field-3-").append('<li class="list-group-item" style="border:none" id="dynamic_field-repopick_topics'+t+'"><div class="row"> <div class="col-md-11 col-xs-11" style="padding-left:0px"> <div class="form-group"> <input autocomplete="on" type="text" id="repopick_topics_text_field'+t+'" name="repopick_topics[]" class="form-control" /> </div> </div> <button type="button" name="remove" id="repopick_topics'+t+'" class="btn btn-danger btn_remove" style="margin-top: 5px;">X</button></div></li>'),$("#repopick_topics_text_field"+t).focus()}),$("body").on("click","#add4",function(){l++,$("#dynamic_field-4-").append('<li class="list-group-item" style="border:none" id="dynamic_field-repopick_changes'+l+'"><div class="row"> <div class="col-md-11 col-xs-11" style="padding-left:0px"> <div class="form-group"> <input autocomplete="on" type="text" id="repopick_changes_text_field'+l+'" name="repopick_changes[]" class="form-control" /> </div> </div> <button type="button" name="remove" id="repopick_changes'+l+'" class="btn btn-danger btn_remove" style="margin-top: 5px;">X</button></div></li>'),$("#repopick_changes_text_field"+l).focus()}),$("#global_override").bootstrapToggle({on:"Yes",off:"No",onstyle:"success",offstyle:"danger"}),$("body").on("change","#global_override",function(){$(this).prop("checked")?($("#default_buildtype_state").trigger("change"),$("#hidden_global_override").val("yes"),$("#switch-block").show()):($("#default_buildtype_state").trigger("change"),$("#hidden_global_override").val("no"),$("#switch-block").hide())}),$("#is_official").bootstrapToggle({on:"Yes",off:"No",onstyle:"success",offstyle:"danger"}),$("body").on("change","#is_official",function(){$(this).prop("checked")?$("#hidden_is_official").val("yes"):$("#hidden_is_official").val("no")}),$("#test_build").bootstrapToggle({on:"Yes",off:"No",onstyle:"success",offstyle:"danger"}),$("body").on("change","#test_build",function(){$(this).prop("checked")?$("#hidden_test_build").val("yes"):$("#hidden_test_build").val("no")}),$("#force_clean").bootstrapToggle({on:"Yes",off:"No",onstyle:"success",offstyle:"danger"}),$("body").on("change","#force_clean",function(){$(this).prop("checked")?$("#hidden_force_clean").val("yes"):$("#hidden_force_clean").val("no")}),$("#default_buildtype_state").bootstrapToggle({on:"Yes",off:"No",onstyle:"success",offstyle:"danger"}),$("body").on("change","#default_buildtype_state",function(){$(this).prop("checked")?($("#hidden_default_buildtype_state").val("yes"),$("#buildtype_div").hide()):($("#hidden_default_buildtype_state").val("no"),$("#buildtype_div").show())}),$("#bootimage").bootstrapToggle({on:"Yes",off:"No",onstyle:"success",offstyle:"danger"}),$("body").on("change","#bootimage",function(){$(this).prop("checked")?$("#hidden_bootimage").val("yes"):$("#hidden_bootimage").val("no")}),$("#override_lunch").bootstrapToggle({on:"Yes",off:"No",onstyle:"success",offstyle:"danger"}),$("body").on("change","#override_lunch",function(){$(this).prop("checked")?($("#hidden_override_lunch").val("yes"),$("#info-con-rem").remove(),$("#config_dev_name").text("Enter lunch name of the device to override:"),$("#config_dev_name").append('<div class="row"> <div class="col-md-12 col-xs-12"> <div class="form-group"> <input autocomplete="on" type="text" name="lunch_override_name" id="lunch_override_name" class="form-control" /> </div> </div> </div>'),$("#lunch_override_name").focus(),null!=n&&"null"!=n&&"NULL"!=n&&""!=n&&($("#lunch_override_name").val(n),s="yes",a("ovr_dev"))):($("#hidden_override_lunch").val("no"),$("#config_dev_name").text(i),s="yes",null!=n&&"null"!=n&&"NULL"!=n&&""!=n&&$("#info-con").append('<i data-toggle="tooltip" class="fa fa-info-circle fa-lg" id="info-con-rem" title="Override data present for '+n+'"></i>'),a("cur_dev"))}),$(document).on("click",".btn_remove",function(){var e=$(this).attr("id");$("#dynamic_field-"+e).remove()}),$("body").on("click","#submit",function(){$.ajax({url:"send_data.php",method:"POST",data:$("#device_changes").serialize(),success:function(e){e=e.trim(),alert(e)}})}),$("body").on("click","#buildTrigger",function(){$.ajax({url:"jenkinsFunc.php",method:"POST",data:{buildTrigger:"yes"},success:function(e){$("#submit").trigger("click"),$("#buildOutput").empty(),e=e.trim(),alert(e)}})}),$("body").on("click","#buildRemoveQueue",function(){$.ajax({url:"jenkinsFunc.php",method:"POST",data:{buildRemoveQueue:"yes"},success:function(e){e=e.trim(),alert(e)}})}),$("body").on("click","#buildStop",function(){$.ajax({url:"jenkinsFunc.php",method:"POST",data:{buildStop:"yes"},success:function(e){e=e.trim(),alert(e)}})}),$("#build-progress-bar").hide(),"Common_config config:"!=d&&$.ajax({method:"POST",url:"jenkinsFunc.php",data:{getHeaderTextSize:"yes"},success:function(e){if(null!=e){var o=JSON.parse(e);window.curTextSize=Number(o["x-text-size"])}}});var d=$("#config_dev_name").text().trim();function r(){window.idleLogSetShown=!0,$.ajax({method:"POST",url:"jenkinsFunc.php",data:{getBodyOutput:"yes",headerTextSize:window.curTextSize},success:function(e){if(null!=e){var o=JSON.parse(e),t=JSON.parse(o.headers),l=o.body;if(window.Morelog=["x-more-data"]in t&&t["x-more-data"],Number(window.curTextSize)==Number(t["x-text-size"]))return;window.curTextSize=Number(t["x-text-size"]),$("#buildOutput").append('<p id="logs">'+l+"</p>"),$("#buildOutput").is(":hover")||$("#buildOutput").scrollTop($("#buildOutput").prop("scrollHeight"))}}})}"Common_config config:"!=d&&c(),$("body").on("click","#fullLog",function(){$.ajax({url:"jenkinsFunc.php",method:"POST",data:{getBodyOutput:"yes",headerTextSize:0},success:function(e){if(null!=e){clearTimeout(window.jenkinsLooper);var o=JSON.parse(e),t=JSON.parse(o.headers),l=o.body;window.curTextSize=Number(t["x-text-size"]),$("#buildOutput").empty(),$("#buildOutput").append('<p id="logs">'+l+"</p>"),c()}}})}),$("body").on("click","#reset-hard",function(){$("#is_official").bootstrapToggle("on"),$("#test_build").bootstrapToggle("off"),$("#force_clean").bootstrapToggle("off"),$("#buildtype").val("userdebug"),$("#bootimage").bootstrapToggle("off")})});